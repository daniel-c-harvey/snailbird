@using Core;
@using RazorCore;

@page "/tabletest"

@rendermode InteractiveServer
@* @attribute [StreamRendering] *@

<PageTitle>Table Test</PageTitle>

<div>
    <NewRowTable TModel="Cash" models="@coins" columnMap="@coinMap" @bind=""/>
</div>

@code{
    private class Cash
    {
        public int Dubloons { get; set; }
        public int Bones { get; set; }
        public int Clams { get; set; }
    }
    private IEnumerable<Cash> coins = new[] { new Cash { Dubloons = 1, Bones = 2 }, 
                                              new Cash { Dubloons = 3, Bones = 4 } };
    private IDictionary<string, ModelColumn<Counted<Cash, int>>> coinMap = new Dictionary<string, ModelColumn<Counted<Cash, int>>>
        {
            { $"{nameof(Cash.Dubloons)} Caption",  new ModelColumn<Counted<Cash, int>>(m => m.Entity.Dubloons, (m,s) => m.Entity.Dubloons = int.TryParse(s))},
            { $"My Fancy {nameof(Cash.Bones)} Caption",  new ModelColumn<Counted<Cash, int>>(m => m.Entity.Bones, (m,s) => m.Entity.Bones = int.TryParse(s))},
            { $"Editable {nameof(Cash.Clams)} Caption", new ModelColumn<Counted<Cash, int>>(m => m.Entity.Clams, (m,s) => m.Entity.Clams = int.TryParse(s), editable:true)}
        };    
}